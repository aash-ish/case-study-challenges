Intro
You are a Customer Insights Analyst for ‘The General Store’
Can you analyse the following tables to find out crucial information about your customers to provide to your marketing team?

SQL challenge 3 Questions and Solutions
---------------------------------------

Q1. What are the names of all the countries in the country table?

select country_name
from country
--------
2. What is the total number of customers in the customers table?

select count(customer_id) as "total number of customers"
from customers
--------
3. What is the average age of customers who can receive marketing emails (can_email is set to ‘yes’)?

select avg(age) as "average age of customers who can receive marketing emails"
from customers
where can_email='yes'
--------
4. How many orders were made by customers aged 30 or older?

select count(order_id) as "orders made by customers aged 30 or older"
from customers
join orders on customers.customer_id=orders.customer_id
where age>=30
--------
5. What is the total revenue generated by each product category?

select category, sum(price) as "total revenue generated by each product category"
from products
join baskets using (product_id) join orders using (order_id)
group by category
--------
6. What is the average price of products in the ‘food’ category?

select avg(price) as "the average price of products in the 'food' category"
from products
where category='food'
--------
7. How many orders were made in each sales channel (sales_channel column) in the orders table?

select sales_channel, count(order_id) as "orders made in each sales channel"
from orders
group by sales_channel
--------
8.What is the date of the latest order made by a customer who can receive marketing emails?

select customers.customer_id, date_shop, can_email,
rank() over(partition by customers.customer_id order by date_shop desc) as "ranko"
from customers
join orders on customers.customer_id=orders.customer_id
where can_email='yes'
--------
9. What is the name of the country with the highest number of orders?

select country_name, count(order_id) "orders placed"
from country
join orders using(country_id)
group by country_name
order by "orders placed" desc
limit 1
--------
10. What is the average age of customers who made orders in the ‘vitamins’ product category?

select round(avg(age)) as "average age of customers who made orders in the vitamins product category"
from customers
join orders using(customer_id) join baskets using(order_id) join products using(product_id)
where category='vitamins'
--------
